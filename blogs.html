<!DOCTYPE html>
<html>
<head>
<title>Yunfei Luo's Personal Website</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=0.4">
<link rel="icon" type="image/x-icon" href="static/images/icon.png" />
<link rel="stylesheet" href="static/css/basic.css">
<script rel="stylesheet" src='static/js/front.js'></script>
<script src="https://kit.fontawesome.com/7dc1dfa47d.js" crossorigin="anonymous"></script>

<!-- React -->
<script src="build/react.development.js"></script>
<script src="build/react-dom.development.js"></script>
<script src="build/babel.min.js"></script>
<!-- Update modules -->
<script type="text/babel" src="update/footer.js"></script>
</head>
<body>
    <header>
        <div class="sidenav">
            <li style="cursor:pointer">
                <a href="index.html" class="active">Home</a>
            </li>
            <li style="cursor:pointer">
                <a href="projects.html" class="active">Projects</a>
            </li>
            <li style="cursor:pointer">
                <a href="blogs.html" class="active">Blogs</a>
            </li>
        </div>
    </header>

    <!-- section 0 -->
    <section class = "blogs">
        <div class = "container">
            <div id="root"></div>
            <h2>Blogs</h2>
            <div class="asidenav" id="list"></div>

            <script type="text/babel">
                class DocList extends React.Component {
                    constructor(props){
                        super(props);
                        this.state = {list: []};
                        this.fetch_projects();
                    }

                    fetch_projects(){
                        let url = 'https://api.github.com/repos/yunfeiluo/yunfeiluo.github.io/git/trees/master';
                        
                        let fetch_list = [];
                        // fetch 1st level
                        fetch(url)
                        .then(res => res.json())
                        .then((out) => {
                            let arr = out["tree"];
                            for (var i = 0; i < arr.length; i++){
                                if (arr[i]["path"] == "articles") {
                                    url = arr[i]["url"];

                                    // fetch 2nd level
                                    fetch(url)
                                    .then(res => res.json())
                                    .then((out) => {
                                        let arr = out["tree"];
                                        for (var i = 0; i < arr.length; i++){
                                            if (arr[i]["path"] == "blogs") {
                                                url = arr[i]["url"];
                                                
                                                // fetch 3rd level
                                                fetch(url)
                                                .then(res => res.json())
                                                .then((out) => {
                                                    let arr = out["tree"];
                                                    for (var i = 0; i < arr.length; i++){
                                                        fetch_list.push(arr[i]["path"]);
                                                    }
                                                    this.setState({list: fetch_list});
                                                }).catch(err => console.error(err));

                                                break;
                                            }
                                        }
                                    }).catch(err => console.error(err));
                                    break;
                                }
                            }
                        }).catch(err => console.error(err));
                    }

                    display_docs(){
                        const list = [];
                        for (let item of this.state.list) {
                            let curr_link = "https://github.com/yunfeiluo/yunfeiluo.github.io/blob/master/articles/blogs/" + item;
                            list.push(
                                <div id = {item} key = {item}>
                                    <a href={curr_link} target="_blank">
                                        {item}
                                    </a>
                                    <br/>
                                </div>
                            );
                        }
                        return (<div>{list}</div>);
                    }

                    // rendor funcion
                    render () {
                        // console.log(this.state.list);
                        return this.display_docs();
                    }
                }
                ReactDOM.render(
                    <DocList></DocList>,
                    document.getElementById("list")
                );
            </script>

            <br/><br/><br/><br/>
            <br/><br/><br/><br/>
        </div>
    </section>

    <!-- The end: footer -->
    <div id="footer"></div>
</body>
</html>